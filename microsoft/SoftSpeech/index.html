<div style="text-align: center;">
<h1><strong>SoftSpeech: Unsupervised Duration Model In FastSpeech 2</strong></h1>
</div>

<div style="text-align: center;">
  <h3>Microsoft, China</h3>
</div>

<div style="text-align: center;">
  <h4>{yuanhyi,helei,peterpan,xwang,yuchao.zhang}@microsoft.com</h4>
</div>

<div style="text-align: left;">
  <h4>In this paper, we propose a neural Text-To-Speech (TTS) system SoftSpeech, which employs a novel soft length regulated duration attention based decoder. It learns the encoder output mapping to decoder output simultaneously from an unsupervised duration model (Soft-LengthRegulator) without the requirement of external duration information. The Soft-LengthRegulator is consist of a Feed-Forward Transformer (FFT) block with Conditional Layer Normalization (CLN), following a learned upsampling layer with multi-head attention and guided multi-head attention constraint, and it is integrated in each decoder layer and achieves accelerated training convergence and better naturalness within FastSpeech 2 framework. Soft Dynamic Time Warping (Soft-DTW) is adopted to align the mismatch spectrogram loss. Moreover, a Fine-Grained style Variational AutoEncoder (VAE) is designed to further improve the naturalness of synthesized speech. The experiments show SoftSpeech outperforms FastSpeech 2 in subjective tests, and can be successfully applied to minority languages with low resources.</h4>
</div>

<div style="text-align: center;">
<img src="./png/model strcuture.png"  alt="model structure" width="925" height="500" />
</div>

<div style="text-align: left;">
  <h3><strong>Multi-lingual Multi-speaker TTS task:</strong></h3>
</div>

<div style="text-align: left;">
  <table width="600" border="1" align="center">
  <tbody>
    <tr>
      <th scope="col">Voice</th>
      <th scope="col">Recording</th>
      <th scope="col">FastSpeech 2</th>
      <th scope="col">SoftSpeech</th>
    </tr>
    <tr>
      <th scope="row">Madarin Male</th>
      <td><audio src="./wav/shy/reference/1.wav" controls=""></audio><br><audio src="./wav/shy/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/shy/baseline/1.wav" controls=""></audio><br><audio src="./wav/shy/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/shy/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/shy/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
    <tr>
      <th scope="row">Madarin Female</th>
      <td><audio src="./wav/gentle/reference/1.wav" controls=""></audio><br><audio src="./wav/gentle/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/gentle/baseline/1.wav" controls=""></audio><br><audio src="./wav/gentle/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/gentle/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/gentle/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
    <tr>
      <th scope="row">English Male</th>
      <td><audio src="./wav/calm/reference/1.wav" controls=""></audio><br><audio src="./wav/calm/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/calm/baseline/1.wav" controls=""></audio><br><audio src="./wav/calm/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/calm/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/calm/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
    <tr>
      <th scope="row">English Female</th>
      <td><audio src="./wav/nervous/reference/1.wav" controls=""></audio><br><audio src="./wav/nervous/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/nervous/baseline/1.wav" controls=""></audio><br><audio src="./wav/nervous/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/nervous/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/nervous/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
  </tbody>
  </table>
</div>

<div style="text-align: left;">
  <h3><strong>Minority low resource TTS task:</strong></h3>
</div>
  
<div style="text-align: left;">
  <table width="600" border="1" align="center">
  <tbody>
    <tr>
      <th scope="col">Voice</th>
      <th scope="col">Recording</th>
      <th scope="col">FastSpeech 2</th>
      <th scope="col">SoftSpeech</th>
    </tr>
    <tr>
      <th scope="row">Estonian Male</th>
      <td><audio src="./wav/female1/reference/1.wav" controls=""></audio><br><audio src="./wav/female1/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/female1/baseline/1.wav" controls=""></audio><br><audio src="./wav/female1/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/female1/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/female1/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
    <tr>
      <th scope="row">Estonian Female</th>
      <td><audio src="./wav/female2/reference/1.wav" controls=""></audio><br><audio src="./wav/female2/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/female2/baseline/1.wav" controls=""></audio><br><audio src="./wav/female2/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/female2/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/female2/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
    <tr>
      <th scope="row">Maltese Male</th>
      <td><audio src="./wav/male1/reference/1.wav" controls=""></audio><br><audio src="./wav/male1/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/male1/baseline/1.wav" controls=""></audio><br><audio src="./wav/male1/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/male1/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/male1/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
    <tr>
      <th scope="row">Maltese Female</th>
      <td><audio src="./wav/male2/reference/1.wav" controls=""></audio><br><audio src="./wav/male2/reference/2.wav" controls=""></audio></td>
      <td><audio src="./wav/male2/baseline/1.wav" controls=""></audio><br><audio src="./wav/male2/baseline/2.wav" controls=""></audio></td>
      <td><audio src="./wav/male2/prosodyspeech/1.wav" controls=""></audio><br><audio src="./wav/male2/prosodyspeech/2.wav" controls=""></audio></td>
    </tr>
  </tbody>
  </table>
</div>